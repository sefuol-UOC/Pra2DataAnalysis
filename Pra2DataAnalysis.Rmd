---
title: "Pra2DataAnalysis"
author: "Author"
date: "5/6/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Limpieza de los datos

```{r}
data <- read.csv("recruitment_decision_tree.csv", header = TRUE, stringsAsFactors = TRUE)
head(data)
```

```{r}
sapply(data, function(x) class(x))
```

## Selección de los datos de interés

```{r}
data <- data[, -(1)]
```

## Ceros y elementos vacíos

```{r}
sapply(data, function(x) sum(is.na(x)))
```

```{r}
suppressWarnings(suppressMessages(library(VIM)))

data$Experience_Years <- kNN(data)$Experience_Years
data$Salary...10E4 <- kNN(data)$Salary...10E4
data$Offer_History <- kNN(data)$Offer_History

sapply(data, function(x) sum(is.na(x)))
```

## Valores extremos

```{r}
boxplot(data$Score)
boxplot.stats(data$Score)$out
```
```{r}
data$Score[data$Score > 23000] <- NA

data$Score <- kNN(data)$Score

boxplot(data$Score)
```

```{r}
boxplot(data$Salary...10E4)
boxplot.stats(data$Salary...10E4)$out
```

```{r}
data$Salary...10E4[data$Salary...10E4 > 500] <- NA

data$Salary...10E4 <- kNN(data)$Salary...10E4

boxplot(data$Salary...10E4)
```

## Exportación de los datos preprocesados

```{r}
write.csv(data, "recruitment_decision_tree_clean.csv")
```